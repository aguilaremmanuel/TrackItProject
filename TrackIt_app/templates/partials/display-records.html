{% load tz %}
{% if documents %}
    {% for document in documents %}

        <tr>
            <td style="white-space: nowrap;">
                {% if search_query %}
                    {{ document.highlighted_tracking_no|safe }}
                {% else %}
                    {{ document.tracking_no }}
                {% endif %}
            </td>
            <td>{{ document.status }}</td>
            <td>
                {% if search_query %}
                    {{ document.highlighted_sender_name|safe }}
                {% else %}
                    {{ document.sender_name }}
                {% endif %}
            </td>
            <td>
                {% if search_query %}
                    {{ document.highlighted_subject|safe }}
                {% else %}
                    {{ document.subject }}
                {% endif %}
            </td>
            <td>{{ document.document_type.category|capfirst }}</td>
            <td>
                {% if document.remarks|length > 28 %}
                    {{ document.remarks|slice:":28" }}&hellip;
                {% else %}
                    {{ document.remarks}}
                {% endif %}
            </td>
            <td style="white-space: nowrap;">
                {{ document.recent_update|date:"Y-m-d" }} <br>
                {{ document.recent_update|timezone:"Asia/Manila"|date:"h:i A" }} 
            </td>
            <td>{{ document.document_type.priority_level.deadline }}
                {% if document.document_type.priority_level.deadline > 1 %}Days{% else %}Day{% endif %}
            </td>

            {% if document.document_type.priority_level.priority_level == "for pref. action" %}
                <td><span class="badge badge-yellow rounded-pill fw-semibold">FOR PREF. ACTION</span></td>
            {% elif document.document_type.priority_level.priority_level == "normal" %}
                <td><span class="badge badge-green rounded-pill fw-semibold">NORMAL</span></td>
            {% elif document.document_type.priority_level.priority_level == "urgent" %}
                <td><span class="badge badge-orange rounded-pill fw-semibold">URGENT</span></td>
            {% elif document.document_type.priority_level.priority_level == "very urgent" %}
                <td><span class="badge badge-red rounded-pill fw-semibold">VERY URGENT</span></td>   
            {% endif %}
            
            {% if user == 'ADO' %}

                {% if document.status == "For Routing" %}
                    <td>
                        <div class="table-action">
                            <button type="button" class="btn btn-sm btn-blue viewDocumentBtn" data-document-no="{{ document.document_no }}" data-bs-toggle="modal" data-bs-target="#viewDocumentModal">
                                <i class="fa-solid fa-eye"></i>
                            </button>
                            <button type="button" class="btn btn-sm btn-green routeDocumentBtn" data-action="route" data-document-no="{{ document.document_no }}" data-bs-toggle="modal" data-bs-target="#routeDocumentModal">
                                <i class="fa-solid fa-route"></i>
                            </button>
                        </div>
                    </td>

                {% elif document.status == "For Archiving" %}
                    <td>
                        <div class="table-action">
                            <button type="button" class="btn btn-sm btn-blue viewDocumentBtn" data-document-no="{{ document.document_no }}" data-bs-toggle="modal" data-bs-target="#viewDocumentModal">
                                <i class="fa-solid fa-eye"></i>
                            </button>
                            <button type="button" class="btn btn-sm btn-red" data-action="archive" data-document-no="{{ document.document_no }}" data-bs-toggle="modal" data-bs-target="#archiveDocumentModal">
                                <i class="fa-solid fa-box-archive"></i>
                            </button>
                        </div>
                    </td>
                {% else %}
                    <td>
                        <div class="table-action">
                            <button type="button" class="btn btn-sm btn-blue viewDocumentBtn" data-document-no="{{ document.document_no }}" data-bs-toggle="modal" data-bs-target="#viewDocumentModal">
                                <i class="fa-solid fa-eye"></i>
                            </button>
                        </div>
                    </td>
                {% endif %}
            
            {% elif user == 'DIR' %}

                {% if document.status == "For DIR Approval" %}
                    <td>
                        <div class="table-action">
                            <button type="button" class="btn btn-sm btn-blue viewDocumentBtn" data-document-no="{{ document.document_no }}" data-bs-toggle="modal" data-bs-target="#viewDocumentModal">
                                <i class="fa-solid fa-eye"></i>
                            </button>
                            <button type="button" class="btn btn-sm btn-green" data-action="approve" data-document-no="{{ document.document_no }}" data-bs-toggle="modal" data-bs-target="#approveDocumentModal">
                                <i class="fa-solid fa-check"></i>
                            </button>
                        </div>
                    </td>
                {% else %}
                    <td>
                        <div class="table-action">
                            <button type="button" class="btn btn-sm btn-blue viewDocumentBtn" data-document-no="{{ document.document_no }}" data-bs-toggle="modal" data-bs-target="#viewDocumentModal">
                                <i class="fa-solid fa-eye"></i>
                            </button>
                        </div>
                    </td>
                {% endif %}

            {% elif user == 'SRO' %}

                {% if document.status == "For SRO Receiving" %}
                    <td>
                        <div class="table-action">
                            <button type="button" class="btn btn-sm btn-blue viewDocumentBtn" data-document-no="{{ document.document_no }}" data-bs-toggle="modal" data-bs-target="#viewDocumentModal">
                                <i class="fa-solid fa-eye"></i>
                            </button>
                            <button type="button" class="btn btn-sm btn-green" data-action="forward" data-document-no="{{ document.document_no }}" data-bs-toggle="modal" data-bs-target="#forwardDocumentModal">
                                <i class="fa-solid fa-share"></i>
                            </button>
                        </div>
                    </td>
                {% elif document.status == "For Resolving" %}
                    <td>
                        <div class="table-action">
                            <button type="button" class="btn btn-sm btn-blue viewDocumentBtn" data-document-no="{{ document.document_no }}" data-bs-toggle="modal" data-bs-target="#viewDocumentModal">
                                <i class="fa-solid fa-eye"></i>
                            </button>
                            <button type="button" class="btn btn-sm btn-green" data-action="resolve" data-document-no="{{ document.document_no }}" data-bs-toggle="modal" data-bs-target="#resolveDocumentModal">
                                <i class="fa-solid fa-flag"></i>
                            </button>
                        </div>
                    </td>
                {% endif %}
                    
            {% elif user ==  'ACT' %}
                <td>
                    <div class="table-action">
                        <button type="button" class="btn btn-sm btn-blue viewDocumentBtn" data-document-no="{{ document.document_no }}" data-bs-toggle="modal" data-bs-target="#viewDocumentModal">
                            <i class="fa-solid fa-eye"></i>
                        </button>
                        <button type="button" class="btn btn-sm btn-green" data-action="endorse" data-document-no="{{ document.document_no }}" data-bs-toggle="modal" data-bs-target="#endorseDocumentModal">
                            <i class="fa-solid fa-gear"></i>
                        </button>
                    </div>
                </td>
            {% endif %}

            
        </tr>
       
    {% endfor %}
{% else %}
    <tr>
        <td colspan="10" class="text-center">No data to display in table.</td>
    </tr>
{% endif %}

<input type="hidden" id="docuLength" value="{{ documents|length|default:'0' }}">